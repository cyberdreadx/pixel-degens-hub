# Yoda Wallet Integration Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Browser Window                           â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Your NFT Marketplace                   â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚           WalletContext (State Manager)             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ isConnected                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ publicKey                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ balance                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ walletType: "seed" | "yoda"                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ isYodaInstalled                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Methods:                                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ connectWallet() â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ connectYodaWallet() â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ disconnectWallet()      â”‚     â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ sendTokens()            â”‚     â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ refreshBalance()        â”‚     â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                 â”‚     â”‚                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚         WalletDialog         â”‚     â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                              â”‚     â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  ğŸŸ¢ Connect Yoda       â”‚â”€â”€â”˜     â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”€â”€â”€ Or use seed phrase â”€â”€â”€        â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Create / Import       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                               â”‚
â”‚                                 â”‚ window.yoda                   â”‚
â”‚                                 â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Yoda Wallet Extension                        â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â€¢ Key Management                                         â”‚  â”‚
â”‚  â”‚  â€¢ Account Storage                                        â”‚  â”‚
â”‚  â”‚  â€¢ Transaction Signing                                    â”‚  â”‚
â”‚  â”‚  â€¢ User Approval UI                                       â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  API:                                                     â”‚  â”‚
â”‚  â”‚  â”œâ”€ connect() â†’ { publicKey }                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ disconnect()                                          â”‚  â”‚
â”‚  â”‚  â”œâ”€ signTransaction(tx) â†’ signedTx                        â”‚  â”‚
â”‚  â”‚  â”œâ”€ getAccounts() â†’ accounts[]                            â”‚  â”‚
â”‚  â”‚  â””â”€ on('event', callback)                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ Keeta Network API
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Keeta Blockchain         â”‚
                    â”‚                            â”‚
                    â”‚  â€¢ Transaction Processing  â”‚
                    â”‚  â€¢ Balance Queries         â”‚
                    â”‚  â€¢ NFT Operations          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Connection Flow - Yoda Wallet

```
User Action                 App                     Yoda Extension
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Click "Connect"       
     â”‚                      
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Show WalletDialog
                           â”‚
                           â”‚ Check window.yoda
                           â”‚
                           â”œâ”€â”€â”€ if exists â”€â”€â”€â–º
                           â”‚                  Show "Connect Yoda"
                           â”‚                  with ğŸŸ¢ indicator
                           â”‚
User clicks                â”‚
"Connect Yoda"             â”‚
     â”‚                     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  yoda.connect()
                           â”‚         â”‚
                           â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Show Approval UI
                                                   (Popup window)
User approves                                      â”‚
     â”‚                                             â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                          Return { publicKey }
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Save state:
                       â€¢ publicKey
                       â€¢ walletType = "yoda"
                       â€¢ isConnected = true
                           â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Fetch balances
                           â”‚                 from blockchain
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Show connected UI
                                            with ğŸŸ£ purple theme
```

## Transaction Flow - Yoda Wallet

```
User Action                 App                     Yoda Extension           Blockchain
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Click "Send Tokens"        
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Build transaction
                           â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  yoda.signTransaction(tx)
                                                   â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Show approval popup
                                                                 â€¢ From: keeta_...
                                                                 â€¢ To: keeta_...
                                                                 â€¢ Amount: 10 KTA
                                                                 
User approves                                                    â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                                         Return signedTx
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Publish transaction
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Process tx
                           â”‚                                                      â”‚
                           â”‚                                                      â”‚
                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                                                 Confirm
                           â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Refresh balances
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Show success toast
```

## Component Hierarchy

```
App.tsx
 â”‚
 â”œâ”€ WalletProvider (WalletContext)
 â”‚   â”‚
 â”‚   â”œâ”€ State Management
 â”‚   â”‚   â”œâ”€ walletType
 â”‚   â”‚   â”œâ”€ isYodaInstalled
 â”‚   â”‚   â”œâ”€ publicKey
 â”‚   â”‚   â”œâ”€ balance
 â”‚   â”‚   â””â”€ tokens
 â”‚   â”‚
 â”‚   â””â”€ Methods
 â”‚       â”œâ”€ connectYodaWallet()
 â”‚       â”œâ”€ connectWallet()
 â”‚       â”œâ”€ sendTokens()
 â”‚       â””â”€ refreshBalance()
 â”‚
 â”œâ”€ Navigation
 â”‚   â””â”€ Connect Button â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                             â”‚
 â””â”€ Pages                      â”‚
     â”œâ”€ Home                   â”‚
     â”œâ”€ Marketplace            â”‚
     â”œâ”€ Profile                â”‚
     â””â”€ NFTDetail              â”‚
                               â”‚
                               â–¼
                      WalletDialog â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€ useWallet()
                           â”‚
                           â”œâ”€ Detection Section
                           â”‚   â””â”€ "ğŸŸ¢ Connect Yoda Wallet"
                           â”‚
                           â”œâ”€ Seed Phrase Section
                           â”‚   â”œâ”€ Create tab
                           â”‚   â””â”€ Import tab
                           â”‚
                           â””â”€ Connected View
                               â”œâ”€ Balance Display
                               â”œâ”€ Send Tokens
                               â”œâ”€ Export Options (conditional)
                               â””â”€ Disconnect Button
```

## Data Flow

### Detection Phase

```
Page Load
    â”‚
    â”œâ”€ WalletContext mounted
    â”‚       â”‚
    â”‚       â””â”€ useEffect() runs
    â”‚               â”‚
    â”‚               â”œâ”€ Check window.yoda
    â”‚               â”œâ”€ Check window.keetaWallet
    â”‚               â”‚
    â”‚               â”œâ”€ if found â”€â”€â”€â”€â”€â–º setIsYodaInstalled(true)
    â”‚               â”‚
    â”‚               â””â”€ Listen for 'yoda#initialized' event
    â”‚
    â””â”€ WalletDialog shows correct button
            â”‚
            â”œâ”€ If installed: "ğŸŸ¢ Connect Yoda Wallet"
            â””â”€ If not installed: "âšª Install Yoda Wallet"
```

### Connection Phase

```
connectYodaWallet() called
    â”‚
    â”œâ”€ Call yoda.connect()
    â”‚       â”‚
    â”‚       â””â”€ Returns { publicKey }
    â”‚
    â”œâ”€ Create Account.fromPublicKeyString(publicKey)
    â”‚
    â”œâ”€ Create UserClient.fromNetwork(network, account)
    â”‚
    â”œâ”€ Override client.initBuilder() to use Yoda signing
    â”‚       â”‚
    â”‚       â””â”€ builder.publish() â†’ yoda.signTransaction()
    â”‚
    â”œâ”€ Update state
    â”‚       â”œâ”€ setAccount(account)
    â”‚       â”œâ”€ setPublicKey(publicKey)
    â”‚       â”œâ”€ setClient(client)
    â”‚       â”œâ”€ setWalletType("yoda")
    â”‚       â””â”€ setIsConnected(true)
    â”‚
    â”œâ”€ Save to localStorage
    â”‚       â””â”€ keetaWalletType = "yoda"
    â”‚
    â””â”€ Set up event listeners
            â”œâ”€ on('accountChanged')
            â””â”€ on('disconnect')
```

### Transaction Phase

```
User initiates transaction (e.g., sendTokens())
    â”‚
    â”œâ”€ Get client from context
    â”‚
    â”œâ”€ Build transaction
    â”‚       â”‚
    â”‚       â””â”€ client.initBuilder()
    â”‚               â”‚
    â”‚               â””â”€ Creates builder with overridden publish()
    â”‚
    â”œâ”€ Call builder.publish()
    â”‚       â”‚
    â”‚       â””â”€ Our override intercepts this
    â”‚               â”‚
    â”‚               â”œâ”€ Get transaction data
    â”‚               â”‚
    â”‚               â””â”€ Call yoda.signTransaction(txData)
    â”‚                       â”‚
    â”‚                       â””â”€ Yoda shows approval popup
    â”‚
    â”œâ”€ User approves in Yoda
    â”‚       â”‚
    â”‚       â””â”€ Returns signed transaction
    â”‚
    â”œâ”€ Signed tx published to blockchain
    â”‚
    â”œâ”€ Wait for confirmation
    â”‚
    â””â”€ Refresh balances
```

## File Interaction Map

```
WalletContext.tsx â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                               â”‚
    â”‚ provides context              â”‚
    â”‚                               â”‚
    â–¼                               â”‚
WalletDialog.tsx                    â”‚
    â”‚                               â”‚
    â”‚ uses                          â”‚
    â”‚                               â”‚
    â–¼                               â”‚
useWallet() hook â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ provides to all components
    â”‚
    â”œâ”€â–º Home.tsx
    â”œâ”€â–º Marketplace.tsx
    â”œâ”€â–º Profile.tsx
    â”œâ”€â–º NFTDetail.tsx
    â”œâ”€â–º Navigation.tsx
    â””â”€â–º Any other component needing wallet access


yoda-wallet.d.ts â”€â”€â”€â–º TypeScript compiler
    â”‚                       â”‚
    â”‚ type definitions       â”‚
    â”‚                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â–º IntelliSense / Type checking
```

## State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Wallet State Machine                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        [Initial State]
              â”‚
              â”‚ Check extension
              â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚
        â–¼            â–¼
   [Detected]   [Not Detected]
        â”‚            â”‚
        â”‚            â””â”€â–º Show "Install" button
        â”‚
        â”‚ User clicks connect
        â”‚
        â–¼
   [Connecting]
        â”‚
        â”‚ yoda.connect()
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    â”‚       â”‚
    â–¼       â–¼
[Connected] [Failed]
    â”‚       â”‚
    â”‚       â””â”€â–º Show error
    â”‚           â”‚
    â”‚           â””â”€â–º Return to [Detected]
    â”‚
    â”‚ User performs actions
    â”‚
    â”œâ”€â–º [Sending Tx] â”€â–º Yoda approval â”€â–º [Connected]
    â”‚
    â”œâ”€â–º [Account Switch] â”€â–º Reconnect â”€â–º [Connected]
    â”‚
    â””â”€â–º [Disconnect] â”€â–º Cleanup â”€â–º [Detected]
```

## Security Boundaries

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Website Context (pixel-degens-hub)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  React App                                           â”‚  â”‚
â”‚  â”‚  â€¢ Can request connection                            â”‚  â”‚
â”‚  â”‚  â€¢ Can request signing                               â”‚  â”‚
â”‚  â”‚  â€¢ Can read public key                               â”‚  â”‚
â”‚  â”‚  â€¢ CANNOT access private keys                        â”‚  â”‚
â”‚  â”‚  â€¢ CANNOT sign without approval                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ window.yoda (injected)
                          â”‚ âœ… Controlled communication
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Extension Context (Yoda Wallet)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Secure Vault                                        â”‚  â”‚
â”‚  â”‚  â€¢ Stores private keys                               â”‚  â”‚
â”‚  â”‚  â€¢ Handles signing                                   â”‚  â”‚
â”‚  â”‚  â€¢ Requires user approval                            â”‚  â”‚
â”‚  â”‚  â€¢ Isolated from website                             â”‚  â”‚
â”‚  â”‚  â€¢ Cannot be accessed by website code                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Security Features:
âœ… Private keys never leave extension
âœ… Every transaction requires user approval
âœ… Website can only request, not execute
âœ… User has full control over all actions
âœ… Keys stored in browser's secure storage
```

## Comparison: Yoda vs Seed Phrase

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Method Comparison                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Aspect        â”‚  Yoda Wallet         â”‚  Seed Phrase         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Keys stored   â”‚  Extension vault     â”‚  localStorage        â”‚
â”‚  Security      â”‚  â­â­â­â­â­            â”‚  â­â­â­              â”‚
â”‚  User approval â”‚  Every transaction   â”‚  None (automatic)    â”‚
â”‚  Setup         â”‚  Install extension   â”‚  None                â”‚
â”‚  Mobile        â”‚  Not available       â”‚  âœ… Available        â”‚
â”‚  Export        â”‚  Via extension       â”‚  Built-in buttons    â”‚
â”‚  Multi-account â”‚  âœ… Native support   â”‚  Manual switch       â”‚
â”‚  UI indicator  â”‚  ğŸŸ£ Purple           â”‚  ğŸ”µ Blue             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Event Flow

```
Extension Events                App Response
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

yoda#initialized event
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º checkYodaWallet()
                                    â”‚
                                    â””â”€â–º Update isYodaInstalled


accountChanged event
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º connectYodaWallet()
                                    â”‚
                                    â””â”€â–º Reconnect with new account
                                            â”‚
                                            â””â”€â–º Update publicKey
                                                    â”‚
                                                    â””â”€â–º Refresh balances


disconnect event
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º disconnectWallet()
                                    â”‚
                                    â””â”€â–º Clear state
                                            â”‚
                                            â””â”€â–º Show disconnected UI
```

## Integration Points

```
Your NFT Marketplace
        â”‚
        â”œâ”€ Navigation.tsx
        â”‚       â”‚
        â”‚       â””â”€ Connect button â”€â”€â”€â”€â”€â–º Opens WalletDialog
        â”‚
        â”œâ”€ Home.tsx
        â”‚       â”‚
        â”‚       â””â”€ useWallet() â”€â”€â”€â”€â”€â”€â”€â”€â–º Get connection status
        â”‚
        â”œâ”€ Marketplace.tsx
        â”‚       â”‚
        â”‚       â””â”€ Buy NFT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Triggers Yoda signing
        â”‚
        â”œâ”€ Profile.tsx
        â”‚       â”‚
        â”‚       â”œâ”€ List NFT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Triggers Yoda signing
        â”‚       â””â”€ Show balance â”€â”€â”€â”€â”€â”€â”€â”€â–º From wallet context
        â”‚
        â””â”€ Any component
                â”‚
                â””â”€ useWallet() â”€â”€â”€â”€â”€â”€â”€â”€â–º Access to:
                                          â€¢ walletType
                                          â€¢ publicKey
                                          â€¢ balance
                                          â€¢ sendTokens()
                                          â€¢ etc.
```

---

This architecture provides:
- âœ… Clear separation of concerns
- âœ… Secure key management
- âœ… User-controlled transactions
- âœ… Backward compatibility
- âœ… Extensible design
- âœ… Type safety
- âœ… Event-driven updates
